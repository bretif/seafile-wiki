Seafevents is added in seafile server 2.1.0. It's responsible for:

* file activities
* office/pdf files online preview
* sending seahub email notifications

== Preparation for Office/PDF document online preivew ==

Office/PDF documents online preview is built on top of [http://www.libreoffice.org libreoffice] and [https://github.com/coolwanglu/pdf2htmlEX pdf2htmlEX].

<code>Libreoffice</code> program and <code>python-uno</code> library is needed to enable office files online preview. If you don't install them, the office documents online preview will be disabled.

On Ubuntu/Debian:
<pre>
sudo apt-get install libreoffice python-uno
</pre>

On Centos/RHEL:
<pre>
sudo yum install libreoffice libreoffice-headless libreoffice-pyuno
</pre>

Also, you need to install fonts for your language on your seafile server machine, otherwise the Office/PDF document online preview may not display correctly.

For example, Chinese users may wish to install the WenQuanYi series of TrueType fonts:
<pre>
# For ubuntu/debian
sudo apt-get install ttf-wqy-microhei ttf-wqy-zenhei xfonts-wqy
</pre>

== Seafevents Configuration ==

In the wiki below, we assume your seafile installation folder is <code>/data/haiwen</code>.

The configuration file is <code>/data/haiwen/seafile-data/seafevents.conf</code>

<pre>
[DATABASE]
type = sqlite3
path = seafevents.db

# Or if you use MySQL
# [DATABASE]
# type=mysql
# username=root
# password=root
# name=seahub
# host=localhost

[OFFICE CONVERTER]

# must be "true" to enable office/pdf file online preview
enabled = true

# How many libreoffice worker processes to run concurrently.
workers = 1

# where to store the converted office/pdf files
outputdir = /tmp/

# how many pages are allowed to be previewed online. Default is 50 pages
max-pages = 50

# the max size of documents to allow to be previewed online, in MB. Default is 2 MB
max-size = 2

[SEAHUB EMAIL]

# must be "true" to enable user email notifications when there are new messages
enabled = true

# interval of sending seahub email. Can be s(seconds), m(minutes), h(hours), d(days)
interval = 30m
</pre>

Every time the configuration is modified, you need to restart seafile server to make it take effect.

<pre>
./seafile.sh restart
</pre>

== Frequently Asked Questions ==

=== The fonts of my Office/PDF online preview does't display correctly ===

This is mainly because you have not installed the fonts.

# Stop seafile server
# Install the fonts
# Remove the folder <code>/tmp/seafile-office-output/</code>
# Start seafile server


=== The email notifications are not sent ===

* Make sure your have configured seahub email notifications according to the [https://github.com/haiwen/seafile/wiki/Seafile-server-configuration-options#wiki-Sending_Email_Notifications_on_Seahub document].
* Check the log file <code>/data/haiwen/seafile-data/logs/seahub.log</code> to see if there is any error message.
